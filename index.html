<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>inHands – Text</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.2/p5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>

  <style>
    /* -------------------------
       FONTS
    ------------------------- */
    @font-face{
      font-family:"GambarinoWeb";
      src:url("./Gambarino_Complete/Fonts/OTF/Gambarino-Regular.otf") format("truetype");
      font-weight:400;
      font-style:normal;
      font-display:swap;
    }
    
    @font-face{
      font-family:"IBMPlexMonoLocal";
      src:url("./IBMPlexMono-Italic.ttf") format("truetype");
      font-weight:400;
      font-style:normal;
      font-display:swap;
    }
    
    /* -------------------------
       GLOBAL
    ------------------------- */
    :root{
      --bg:#ffffff;
      --fg:#111111;
      --muted:#6b6b6b;
      --line:#bdbdbd;
      --pad:22px;
    }
    
    *{ box-sizing:border-box; }
    
    html, body{
      height:100%;
      margin:0;
      overflow:hidden; /* la pagina non scrolla mai */
    }
    
    body{
      background:var(--bg);
      color:var(--fg);
      font-family:system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      transition: background-color 420ms linear;
    }
    
    /* -------------------------
       PAGE GRID
    ------------------------- */
    .page{
      width:100vw;
      height:100vh;
      display:grid;
      grid-template-columns:360px 1fr 360px;
      overflow:hidden;
    }
    
    /* -------------------------
       LEFT COLUMN
    ------------------------- */
    .col-left{
      padding:var(--pad);
      border-right:1px solid var(--line);
      display:flex;
      flex-direction:column;
      gap:18px;
    }
    
    .brand{
      height:100px;
      display:flex;
      align-items:flex-start;
    }
    
    .brand img{
      width:100%;
      height:auto;
      display:block;
    }
    
    .nav{
      display:flex;
      flex-direction:row;
      gap:18px;
      align-items:flex-start;
    }
    
    .nav a{
      display:inline-block;
      padding:8px 18px;
      border:1px solid var(--fg);
      text-decoration:none;
      font-size:12px;
      color:var(--fg);
      background:transparent;
      width:90px;
      text-align:center;
      font-family:"IBMPlexMonoLocal", monospace;
      letter-spacing:0.04em;
      font-weight:400;
    }
    
    .nav a:visited,
    .nav a:active,
    .nav a:hover{
      color:var(--fg);
    }
    
    .nav a.active{
      background:var(--fg);
      color:#ffffff;
    }
    
    .divider{
  height: 6px;
  margin: 14px 0 18px 0;

  background-image: radial-gradient(circle, var(--line) 1px, transparent 1px);
  background-size: 6px 6px;   /* distanza tra i punti */
  background-repeat: repeat-x;
  background-position: left center;
}
    
    .desc{
      font-size:11px;
      line-height:1.5;
      white-space:pre-wrap;
      font-family:"IBMPlexMonoLocal", monospace;
      letter-spacing:0.04em;
      font-weight:400;
    }
    
    .info-toggle{
      margin-top:12px;
      padding:0;
      background:transparent;
      border:none;
      cursor:pointer;
      font-size:12px;
      color:var(--fg);
      font-family:"IBMPlexMonoLocal", monospace;
      letter-spacing:0.04em;
      font-weight:400;
      align-self:flex-start;
      text-align:left;
    }
    
    .info-toggle:hover{ text-decoration:underline; }
    
    /* -------------------------
       CENTER COLUMN
    ------------------------- */
    .col-center{
      padding:var(--pad);
      border-right:1px solid var(--line);
      display:block;
      min-height:0;
    }
    
    .poem-scroll{
      max-width:540px;
      width:100%;
      height:calc(100vh - (var(--pad) * 2));
      margin-top:14px;
      position:relative;
      overflow:hidden;
      font-family:"GambarinoWeb", serif;
      font-size:24px;
      line-height:1.25;
    }
    
    .poem-inner{
      position:absolute;
      left:0;
      right:0;
      top:0;
      white-space:pre-wrap;
      will-change:transform, opacity, filter;
      opacity:0.18;
      -webkit-mask-repeat:repeat;
      mask-repeat:repeat;
      font-family:"GambarinoWeb", serif !important;
    }
    
    .poem-scroll.state-open .poem-inner{
      opacity:1;
      -webkit-mask-image:none;
      mask-image:none;
    }
    
    .poem-scroll.state-semi .poem-inner{
      opacity:0.55;
      -webkit-mask-image:linear-gradient(
        to bottom,
        rgba(0,0,0,0),
        rgba(0,0,0,1) 22%,
        rgba(0,0,0,1) 78%,
        rgba(0,0,0,0)
      );
      mask-image:linear-gradient(
        to bottom,
        rgba(0,0,0,0),
        rgba(0,0,0,1) 22%,
        rgba(0,0,0,1) 78%,
        rgba(0,0,0,0)
      );
    }
    
    .poem-scroll.state-closed .poem-inner,
    .poem-scroll.state-none .poem-inner{
      opacity:0.18;
      -webkit-mask-image:none;
      mask-image:none;
    }
    
    .poem-block{
      display:block;
      white-space:pre-wrap;
      margin:0 0 0.65em 0;
      transition:letter-spacing 420ms linear, opacity 420ms linear;
    }
    
    .poem-char{
      display:inline-block;
      will-change:transform;
      font-family:"GambarinoWeb", serif !important;
    }
    
    .poem-space{
      display:inline-block;
      width:0.33em;
    }
    
    .poem-br{
      display:block;
      height:0.1em;
    }
    
    /* -------------------------
       RIGHT COLUMN
    ------------------------- */
    .col-right{
      display:grid;
      grid-template-rows:1fr 1fr;
      height:100%;
      min-height:0;
    }
    
    .panel{
      padding:var(--pad);
      position:relative;
      min-height:0;
      padding:0px;
    }
    
    .panel + .panel{
      border-top:1px solid var(--line);
    }
    
    .panel-box{
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      overflow:hidden;
      min-height:0;
    }
    
    .panel-label{
      position:center;
      top:8px;
      left:8px;
      font-size:10px;
      text-transform:lowercase;
      color:var(--muted);
      pointer-events:none;
      font-family:"IBMPlexMonoLocal", monospace;
      letter-spacing:0.04em;
      font-weight:400;
    }
    
    #canvas-holder{
      position:absolute;
      inset:0;
    }
    
    /* -------------------------
       EXPLANATION PANEL
       (scrolla solo il box in basso a destra)
    ------------------------- */
    .panel-box-explain{
  height: 100%;
  overflow: auto;

  display: flex;
  flex-direction: column;

  align-items: center;      /* centra orizzontalmente */
  justify-content: flex-start;  /* ← IMPORTANTISSIMO: in alto */

  padding: 10px 0;
  margin-top: 20px;
}
    
    .explain-inner{
      width:min(420px, 82%);
      margin:0 auto;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
    }
    
    .explain-icons{
      display:flex;
      gap:14px;
      justify-content:center;
      width:100%;
    }
    
    .explain-icon{
      width:100px;
      height:100px;
      border:1px solid var(--line);
      background:none;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    
    .explain-icon img{
      width:60px;
      height:auto;
      display:block;
    }
    
    .explain-toggle{
      background:transparent;
      border:none;
      cursor:pointer;
      padding:0;
      font-family:"IBMPlexMonoLocal", monospace;
      font-size:12px;
      letter-spacing:0.04em;
      font-style:italic;
      color:var(--fg);
    }
    
    .explain-toggle:hover{ text-decoration:underline; }
    
    .explain-body{
      display:none;
      width:100%;
    }
    
    .explain-body.is-open{
      display:block;
    }
    
    .explain-text{
      width:100%;
      margin-top: 40px;
      margin-bottom: 40px;
      font-family:"IBMPlexMonoLocal", monospace;
      font-size:11px;
      line-height:1.55;
      letter-spacing:0.04em;
      color:var(--fg);
    }
    
    .explain-text p{
      margin:0 0 12px 0;
    }
    
    /* -------------------------
       STATUS
    ------------------------- */
    .status{
      position:fixed;
      left:12px;
      bottom:12px;
      font-size:12px;
      color:var(--muted);
      background:rgba(255,255,255,0.9);
      border:1px solid var(--line);
      padding:6px 10px;
      font-family:"IBMPlexMonoLocal", monospace;
      letter-spacing:0.04em;
      font-weight:400;
      z-index:150;
    }
    
    /* -------------------------
       FLOATING INFO LAYER
    ------------------------- */
    .info-layer{
      position:fixed;
      inset:0;
      display:none;
      z-index:200;
    }
    
    .info-layer.is-open{ display:block; }
    
    .info-backdrop{
      position:absolute;
      inset:0;
      background:transparent;
    }
    
    .info-card{
      position:absolute;
      background:#fff;
      border:1px solid var(--fg);
      padding:36px 40px;
      width:640px;
      max-width:72vw;
      max-height:64vh;
      display:flex;
      flex-direction:column;
    }
    
    .info-content{
      flex:1 1 auto;
      overflow:auto;
      font-family:"IBMPlexMonoLocal", monospace;
      font-size:12px;
      line-height:1.6;
      letter-spacing:0.04em;
      color:var(--fg);
    }
    
    .info-content p{ margin:0 0 18px 0; }
    
    .info-close{
      margin-top:18px;
      align-self:flex-end;
    }
    
    /* -------------------------
       INTRO OVERLAY (2 STEPS)
    ------------------------- */
    .intro-overlay{
  display:none;
  position:fixed;
  inset:0;

  /* Serve per rendere visibile il blur */
  background: rgba(255, 244, 244, 0.62);

  /* Blur vero */
  -webkit-backdrop-filter: blur(5px);
  backdrop-filter: blur(5px);

  /* Se il blur non viene supportato, almeno resta un velo */
  z-index: 9999;
  align-items: center;
  justify-content: center;
}
    
    .intro-panel{
      width:880px;
      max-width:88vw;
      background:none;
      border:1px solid #111;
      padding:58px 70px 72px 70px;
      position:relative;
    }
    
    .intro-step{ display:none; }
    .intro-step.is-active{ display:block; }
    
    .intro-logo{
      text-align:center;
      margin-bottom:42px;
    }
    
    .intro-logo img{
      max-width:320px;
      height:auto;
      display:inline-block;
    }
    
    .intro-content{
      display:grid;
      grid-template-columns:180px 1fr;
      column-gap:60px;
      align-items:start;
    }
    
    .intro-title{
      font-family:"IBMPlexMonoLocal", monospace;
      font-size:12px;
      letter-spacing:0.04em;
      font-style:italic;
      margin:0;
    }
    
    .intro-text{
      font-family:"IBMPlexMonoLocal", monospace;
      font-size:12px;
      letter-spacing:0.04em;
      line-height:1.6;
      margin:0;
      color:#111;
    }
    
    .intro-next,
    .intro-back{
      position:absolute;
      bottom:34px;
      background:transparent;
      border:none;
      cursor:pointer;
      font-family:"IBMPlexMonoLocal", monospace;
      font-size:12px;
      letter-spacing:0.04em;
      font-style:italic;
      color:#111;
      padding:0;
    }
    
    .intro-next{ right:44px; }
    .intro-back{ left:44px; }
    
    .intro-next:hover,
    .intro-back:hover{
      text-decoration:underline;
    }
    
    .intro-content-gestures{
      margin-top:10px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    
    .intro-gestures{
      display:flex;
      justify-content:center;
      gap:72px;
      margin-top:15px;
    }
    
    .intro-gesture{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap:14px;
    }
    
    .intro-gesture img{
      width:120px;
      height:auto;
      border:1px solid #111;
      background:none;
      padding:10px;
      display:block;
    }
    
    .intro-gesture span{
      font-family:"IBMPlexMonoLocal", monospace;
      font-size:12px;
      letter-spacing:0.04em;
      font-style:italic;
      color:#111;
    }

    /* Blocca completamente lo scroll della pagina */
html, body{
  height: 100%;
  overflow: hidden;
}

/* La griglia occupa tutta l’altezza e non può generare scroll */
.page{
  height: 100vh;
  overflow: hidden;
}

/* Permette agli elementi interni (come panel-box-explain) di scrollare */
.col-right,
.panel,
.panel-box{
  min-height: 0;
}
    </style>
</head>

<body>

  <!-- INTRO OVERLAY -->
  <div class="intro-overlay" id="introOverlay" aria-hidden="false">
    <div class="intro-panel" role="dialog" aria-modal="true" aria-label="How to interact">

      <!-- STEP 1 -->
      <section class="intro-step is-active" id="introStep1">
        <div class="intro-logo">
          <img src="logo3.png" alt="inHands">
        </div>

        <div class="intro-content">
          <p class="intro-title">How to interact</p>
          <p class="intro-text">
            This interface responds to three simple hand gestures.<br>
            Please allow access to your camera. The system uses live video input to detect your hand only.<br>
            Raise your hand in front of the camera and let the interface recognize your movement.
          </p>
        </div>

        <button class="intro-next" type="button" id="introNextBtn">Next →</button>
      </section>

      <!-- STEP 2 -->
      <section class="intro-step" id="introStep2">
        <div class="intro-logo">
          <img src="logo3.png" alt="inHands">
        </div>

        <div class="intro-content intro-content-gestures">
          <div class="intro-gestures">
            <div class="intro-gesture">
              <img src="imgs/open.png" alt="Open Hand">
              <span>Open Hand</span>
            </div>
        
            <div class="intro-gesture">
              <img src="imgs/semi.png" alt="Semi Closed">
              <span>Semi Closed</span>
            </div>
        
            <div class="intro-gesture">
              <img src="imgs/closed.png" alt="Closed">
              <span>Closed</span>
            </div>
          </div>
        </div>

        <button class="intro-back" type="button" id="introBackBtn">← Back</button>
        <button class="intro-next" type="button" id="introEnterBtn">Enter →</button>      </section>

    </div>
  </div>

  <!-- MAIN PAGE -->
  <div class="page">

    <aside class="col-left">
      <div class="brand">
        <img src="logo3.png" alt="inHands">
      </div>

      <nav class="nav">
        <a class="active" href="index.html">Text</a>
        <a href="sound.html">Sound</a>
        <a href="space.html">Space</a>
      </nav>

      <div class="divider"></div>

      <div class="desc">
This work investigates hand gestures as forms of non-verbal communication.
Three gestures examine how emotion can
shape perception and how digital visual communication can reveal and amplify their expressive potential.
      </div>

      <button class="info-toggle" id="openInfo" type="button">↓ more info</button>
    </aside>

    <main class="col-center">
      <section class="poem-scroll state-none" id="poemScroll">
        <div class="poem-inner" id="poemInner"></div>
      </section>
    </main>

    <aside class="col-right">
      <section class="panel">
        <div class="panel-box">
          <div id="canvas-holder"></div>
          <div class="panel-label">Show your hand</div>
        </div>
      </section>

      <section class="panel">
        <div class="panel-box panel-box-explain">
          <div class="explain-inner">
        
            <div class="explain-icons">
              <div class="explain-icon"><img src="imgs/open.png" alt="Open Hand"></div>
              <div class="explain-icon"><img src="imgs/semi.png" alt="Semi Closed"></div>
              <div class="explain-icon"><img src="imgs/closed.png" alt="Closed"></div>
            </div>
        
            <button class="explain-toggle" id="explainToggle" type="button">Click for explanation ↓</button>
        
            <div class="explain-body" id="explainBody" aria-hidden="true">
              <div class="explain-text">
                <p>This section is built around Pablo Neruda’s poem Clenched Soul, structured into fragments that reflect different emotional states. <p>The selected fragments move between presence and absence, warmth and distance. Images of light, sunset and touch coexist with memory, longing and the anxiety of separation. Even movements outside the three recognized gestures still affect the interface, suggesting that any gesture carries emotional weight.</p>
                <p>The poem becomes a shifting emotional field rather than a fixed linear text.</p>
        
                <br><p><strong>Open Hand → Joy</strong><br>The luminous fragments of the poem emerge. Lines describing the sunset, light and physical presence become fully legible, with increased space and clarity. The text feels open and breathable, echoing the immediacy and warmth of love as something tangible and held.</p>
        
                <p><strong>Semi Closed Hand → Sadness</strong><br>Verses centered on memory and distance take prominence. Twilight, loss and longing surface through partial visibility and subtle fragmentation. The layout becomes less stable, suggesting the emotional disorientation of remembering someone who is no longer fully present.</p>
        
                <p><strong>Closed Fist → Fear</strong><br>The most tense and uncertain lines come forward. Questions, doubt and images of abandonment are emphasized. The text compresses and tightens, reducing space and increasing density, reflecting the contraction and anxiety embedded in these fragments.</p>
              </div>
            </div>
        
          </div>
        </div>
      </section>
    </aside>

  </div>

  <div class="status" id="status">Loading camera…</div>

  <!-- FLOATING LAYER OUTSIDE GRID -->
  <div class="info-layer" id="infoLayer" aria-hidden="true">
    <div class="info-backdrop" id="infoBackdrop"></div>

    <div class="info-card" id="infoCard" role="dialog" aria-modal="true" aria-label="Project information">
      <div class="info-content">
        <p>
          This project explores the hand as a primary form of expression. Before language, the body already communicates through gesture. Here, digital environments make minimal movements visible, translating them into emotional states.        </p>

        <p>
          The work unfolds across three dimensions: text, sound and space. Each responds to the same three gestures, open hand, half-closed hand and closed fist, associated with joy, sadness and fear.
        <p>
          In the textual dimension, gesture alters the legibility and structure of a poem. In the sound dimension, a violin composition shifts in tone and intensity, supported by a reactive visualization. In the spatial dimension, the interface expands, destabilizes or compresses, reflecting how emotion shapes the way space is perceived and inhabited.
        <p>
          The proposed classification of gestures and emotions remains intentionally open. It serves as a demonstrative framework rather than a universal system, suggesting that meaning can emerge from gesture while remaining multiple and interpretative. </p>
      </div>

      <button class="info-toggle info-close" id="closeInfo" type="button">↑ less info</button>
    </div>
  </div>

  <!-- Your p5 / mediapipe logic -->
  <script src="sketch.js"></script>

  <script>
  // INFO LAYER (il tuo codice, invariato a livello logico)
  const openInfo = document.getElementById("openInfo");
  const closeInfo = document.getElementById("closeInfo");
  const infoLayer = document.getElementById("infoLayer");
  const infoCard = document.getElementById("infoCard");
  const infoBackdrop = document.getElementById("infoBackdrop");

  function positionCardUnderButton(){
    const r = openInfo.getBoundingClientRect();
    const gap = 12;

    let left = r.left;
    let top = r.bottom + gap;

    const vw = window.innerWidth;
    const vh = window.innerHeight;

    const cardW = Math.min(640, vw * 0.72);
    infoCard.style.width = cardW + "px";

    const cardRect = infoCard.getBoundingClientRect();
    const maxLeft = vw - cardRect.width - 12;
    const maxTop = vh - cardRect.height - 12;

    left = Math.max(12, Math.min(left, maxLeft));
    top = Math.max(12, Math.min(top, maxTop));

    infoCard.style.left = left + "px";
    infoCard.style.top = top + "px";
  }

  function openLayer(){
    infoLayer.classList.add("is-open");
    infoLayer.setAttribute("aria-hidden", "false");
    positionCardUnderButton();
  }

  function closeLayer(){
    infoLayer.classList.remove("is-open");
    infoLayer.setAttribute("aria-hidden", "true");
  }

  openInfo.addEventListener("click", openLayer);
  closeInfo.addEventListener("click", closeLayer);
  infoBackdrop.addEventListener("click", closeLayer);

  window.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && infoLayer.classList.contains("is-open")) {
      closeLayer();
    }
  });

  window.addEventListener("resize", () => {
    if (infoLayer.classList.contains("is-open")) positionCardUnderButton();
  });

  window.addEventListener("scroll", () => {
    if (infoLayer.classList.contains("is-open")) positionCardUnderButton();
  }, { passive: true });
  </script>

<script>
  (function(){
    const btn = document.getElementById("explainToggle");
    const body = document.getElementById("explainBody");
    if (!btn || !body) return;
  
    btn.addEventListener("click", () => {
      const isOpen = body.classList.toggle("is-open");
      body.setAttribute("aria-hidden", String(!isOpen));
      if (isOpen) body.scrollTop = 0;
    });
  })();
  </script>


<script>
  (function(){
    const overlay = document.getElementById("introOverlay");
    const step1 = document.getElementById("introStep1");
    const step2 = document.getElementById("introStep2");
    const nextBtn = document.getElementById("introNextBtn");
    const backBtn = document.getElementById("introBackBtn");
    const enterBtn = document.getElementById("introEnterBtn");
  
    if (!overlay || !step1 || !step2) return;
  
    function showStep(n){
      if (n === 1){
        step1.classList.add("is-active");
        step2.classList.remove("is-active");
      } else {
        step1.classList.remove("is-active");
        step2.classList.add("is-active");
      }
    }
  
    function openIntro(){
      overlay.style.display = "flex";
      overlay.setAttribute("aria-hidden", "false");
      showStep(1);
    }
  
    function closeIntro(){
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden", "true");
      localStorage.setItem("introSeen", "true");
    }
  
    // Mostra solo se non visto
    if (!localStorage.getItem("introSeen")) {
      openIntro();
    } else {
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden", "true");
    }
  
    if (nextBtn) nextBtn.addEventListener("click", () => showStep(2));
    if (backBtn) backBtn.addEventListener("click", () => showStep(1));
    if (enterBtn) enterBtn.addEventListener("click", closeIntro);
  })();
  </script>

</body>
</html>